# these are policies required by following Polarion test cases:
# RHACM4K-548
# RHACM4K-549
# RHACM4K-550
# RHACM4K-551
# RHACM4K-552
# RHACM4K-553
# RHACM4K-634
# RHACM4K-660
# RHACM4K-661
# RHACM4K-901
# RHACM4K-902
# RHACM4K-903
# RHACM4K-904
# RHACM4K-1569

test-iam-policy-[ID]:
  apiVersion: 'policy.open-cluster-management.io/v1'
  namespace: 'default'
#  cluster_binding:
#    - 'name: "dhaks1020-2-dho-461"'
#    - 'local-cluster: "true"'
  binding_selector:
    - 'matchExpressions =[]'
#    - 'matchExpressions =[ { "key": "name", "operator": "In", "values": [ "dhaks1020-2-dho-461" ] } ]'
#    - 'matchExpressions =[ { "key": "local-cluster", "operator": "In", "values": [ "true" ] } ]'
  kind: 'IamPolicy'
  specifications:
    - 'IamPolicy'
  standards:
    - 'NIST-CSF'
  categories:
    - 'PR.AC Identity Management and Access Control'
  controls:
    - 'PR.AC-4 Access Control'
  enforce: False
  disable: False

test-pod-security-policy-[ID]:
  apiVersion: 'policy.open-cluster-management.io/v1'
  namespace: 'default'
#  cluster_binding:
#    - 'name: "dhaks1020-2-dho-461"'
#    - 'local-cluster: "true"'
  binding_selector:
    - 'matchExpressions =[]'
#    - 'matchExpressions =[ { "key": "name", "operator": "In", "values": [ "dhaks1020-2-dho-461" ] } ]'
#    - 'matchExpressions =[ { "key": "local-cluster", "operator": "In", "values": [ "true" ] } ]'
  kind: 'ConfigurationPolicy'
  specifications:
    - 'PodSecurityPolicy'
  standards:
    - 'NIST-CSF'
  categories:
    - 'PR.PT Protective Technology'
  controls:
    - 'PR.PT-3 Least Functionality'
  enforce: False
  disable: 

test-role-policy-[ID]:
  apiVersion: 'policy.open-cluster-management.io/v1'
  namespace: 'default'
#  cluster_binding:
#    - 'name: "dhaks1020-2-dho-461"'
#    - 'local-cluster: "true"'
  binding_selector:
    - 'matchExpressions =[]'
#    - 'matchExpressions =[ { "key": "name", "operator": "In", "values": [ "dhaks1020-2-dho-461" ] } ]'
#    - 'matchExpressions =[ { "key": "local-cluster", "operator": "In", "values": [ "true" ] } ]'
  kind: 'ConfigurationPolicy'
  specifications:
    - 'Role - Role must follow defined permissions'
  standards:
    - 'NIST-CSF'
  categories:
    - 'PR.AC Identity Management and Access Control'
  controls:
    - 'PR.AC-4 Access Control'
  enforce: False
  disable: False

test-role-binding-policy-[ID]:
  apiVersion: 'policy.open-cluster-management.io/v1'
  namespace: 'default'
#  cluster_binding:
#    - 'name: "dhaks1020-2-dho-461"'
#    - 'local-cluster: "true"'
  binding_selector:
    - 'matchExpressions =[]'
#    - 'matchExpressions =[ { "key": "name", "operator": "In", "values": [ "dhaks1020-2-dho-461" ] } ]'
#    - 'matchExpressions =[ { "key": "local-cluster", "operator": "In", "values": [ "true" ] } ]'
  kind: 'ConfigurationPolicy'
  specifications:
    - 'Role - Role must follow defined permissions'
  standards:
    - 'NIST-CSF'
  categories:
    - 'PR.AC Identity Management and Access Control'
  controls:
    - 'PR.AC-4 Access Control'
  enforce: False
  disable: False

test-security-context-constraints-policy-[ID]:
  apiVersion: 'policy.open-cluster-management.io/v1'
  namespace: 'default'
#  cluster_binding:
#    - 'name: "dhaks1020-2-dho-461"'
#    - 'local-cluster: "true"'
  binding_selector:
    - 'matchExpressions =[]'
#    - 'matchExpressions =[ { "key": "name", "operator": "In", "values": [ "dhaks1020-2-dho-461" ] } ]'
#    - 'matchExpressions =[ { "key": "local-cluster", "operator": "In", "values": [ "true" ] } ]'
  kind: 'ConfigurationPolicy'
  specifications:
    - 'SecurityContextConstraints'
  standards:
    - 'NIST-CSF'
  categories:
    - 'PR.PT Protective Technology'
  controls:
    - 'PR.PT-3 Least Functionality'
  enforce: False
  disable: False
